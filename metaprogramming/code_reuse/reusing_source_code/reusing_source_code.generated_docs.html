<!DOCTYPE HTML>
<html lang="en" class="navy" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Reusing Source Code - The Claro Programming Language (DRAFT)</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../../custom_blocks.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('navy')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../../chapter_1.html">Welcome to Claro!</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">User Guide</li><li class="chapter-item expanded "><a href="../../../chapter_1/hello_world.generated_docs.html"><strong aria-hidden="true">1.</strong> Hello, World</a></li><li class="chapter-item expanded "><a href="../../../getting_started/getting_started.html"><strong aria-hidden="true">2.</strong> Getting Started!</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../getting_started/understanding_starter_project/understanding_starter_project.generated_docs.html"><strong aria-hidden="true">2.1.</strong> Understanding the Starter Project</a></li><li class="chapter-item expanded "><a href="../../../getting_started/first_program/first_program.generated_docs.html"><strong aria-hidden="true">2.2.</strong> Your First Program</a></li><li class="chapter-item expanded "><a href="../../../getting_started/intro_to_modules/intro_to_modules.generated_docs.html"><strong aria-hidden="true">2.3.</strong> Intro to Modules</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Reference Guide</li><li class="chapter-item expanded "><a href="../../../common_programming_concepts.html"><strong aria-hidden="true">3.</strong> Common Programming Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../common_programming_concepts/variables_and_types/variables_and_types.generated_docs.html"><strong aria-hidden="true">3.1.</strong> Variables & Primitive Types</a></li><li class="chapter-item expanded "><a href="../../../common_programming_concepts/sep_var_decl_and_init/sep_var_decl_and_init.generated_docs.html"><strong aria-hidden="true">3.2.</strong> Separate Variable Declaration & Initialization</a></li><li class="chapter-item expanded "><a href="../../../common_programming_concepts/var_reassignment/var_reassignment.generated_docs.html"><strong aria-hidden="true">3.3.</strong> Variable Reassignment</a></li><li class="chapter-item expanded "><a href="../../../common_programming_concepts/string_formatting/string_formatting.generated_docs.html"><strong aria-hidden="true">3.4.</strong> String Formatting</a></li><li class="chapter-item expanded "><a href="../../../control_flow.html"><strong aria-hidden="true">3.5.</strong> Control Flow</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../control_flow/if_else/if_else.generated_docs.html"><strong aria-hidden="true">3.5.1.</strong> If-Else</a></li><li class="chapter-item expanded "><a href="../../../control_flow/while/while.generated_docs.html"><strong aria-hidden="true">3.5.2.</strong> While</a></li><li class="chapter-item expanded "><a href="../../../control_flow/for/for.generated_docs.html"><strong aria-hidden="true">3.5.3.</strong> For</a></li><li class="chapter-item expanded "><a href="../../../control_flow/repeat/repeat.generated_docs.html"><strong aria-hidden="true">3.5.4.</strong> Repeat</a></li><li class="chapter-item expanded "><a href="../../../control_flow/pipes/pipes.generated_docs.html"><strong aria-hidden="true">3.5.5.</strong> Pipes</a></li><li class="chapter-item expanded "><a href="../../../control_flow/match/match.generated_docs.html"><strong aria-hidden="true">3.5.6.</strong> Pattern Matching</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../control_flow/match/structed_data/structured_data.generated_docs.html"><strong aria-hidden="true">3.5.6.1.</strong> Matching Structured Data</a></li><li class="chapter-item expanded "><a href="../../../control_flow/match/wildcards/wildcards.generated_docs.html"><strong aria-hidden="true">3.5.6.2.</strong> Wildcard Patterns</a></li><li class="chapter-item expanded "><a href="../../../control_flow/match/exhaustiveness_checks/exhaustiveness_checks.generated_docs.html"><strong aria-hidden="true">3.5.6.3.</strong> Static Exhaustiveness Checks</a></li></ol></li><li class="chapter-item expanded "><a href="../../../control_flow/collection_comprehension/collection_comprehension.generated_docs.html"><strong aria-hidden="true">3.5.7.</strong> Collection Comprehension</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../control_flow/collection_comprehension/more_than_syntax_sugar/more_than_syntax_sugar.generated_docs.html"><strong aria-hidden="true">3.5.7.1.</strong> Comprehension is More Than Syntax Sugar</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../static_typing/static_typing.generated_docs.html"><strong aria-hidden="true">4.</strong> Types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../static_typing/builtin_colls/builtin_collections.generated_docs.html"><strong aria-hidden="true">4.1.</strong> Builtin Collections</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../static_typing/builtin_colls/list_type/list_type.generated_docs.html"><strong aria-hidden="true">4.1.1.</strong> Lists</a></li><li class="chapter-item expanded "><a href="../../../static_typing/builtin_colls/set_type/set_type.generated_docs.html"><strong aria-hidden="true">4.1.2.</strong> Sets</a></li><li class="chapter-item expanded "><a href="../../../static_typing/builtin_colls/map_type/map_type.generated_docs.html"><strong aria-hidden="true">4.1.3.</strong> Maps</a></li><li class="chapter-item expanded "><a href="../../../static_typing/builtin_colls/tuple_type/tuple_type.generated_docs.html"><strong aria-hidden="true">4.1.4.</strong> Tuples</a></li><li class="chapter-item expanded "><a href="../../../static_typing/builtin_colls/struct_type/struct_type.generated_docs.html"><strong aria-hidden="true">4.1.5.</strong> Structs</a></li></ol></li><li class="chapter-item expanded "><a href="../../../static_typing/oneofs/oneofs.generated_docs.html"><strong aria-hidden="true">4.2.</strong> Oneofs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../static_typing/oneofs/narrowing/narrowing.generated_docs.html"><strong aria-hidden="true">4.2.1.</strong> "Narrowing" / Type Guards</a></li></ol></li><li class="chapter-item expanded "><a href="../../../static_typing/atoms/atoms.generated_docs.html"><strong aria-hidden="true">4.3.</strong> Atoms</a></li><li class="chapter-item expanded "><a href="../../../static_typing/aliases/aliases.generated_docs.html"><strong aria-hidden="true">4.4.</strong> Aliases</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../static_typing/aliases/not_a_new_type_decl/not_a_new_type_decl.generated_docs.html"><strong aria-hidden="true">4.4.1.</strong> Aliases are Not a New Type Declaration</a></li></ol></li><li class="chapter-item expanded "><a href="../../../static_typing/user_defined_types/user_defined_types.generated_docs.html"><strong aria-hidden="true">4.5.</strong> User Defined Types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../static_typing/user_defined_types/parameterized_types/parameterized_types.generated_docs.html"><strong aria-hidden="true">4.5.1.</strong> Parameterized Types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../static_typing/user_defined_types/parameterized_types/concrete_type_inference/concrete_type_inference.generated_docs.html"><strong aria-hidden="true">4.5.1.1.</strong> Concrete Type Inference</a></li></ol></li><li class="chapter-item expanded "><a href="../../../static_typing/user_defined_types/recursive_types/recursive_types.generated_docs.html"><strong aria-hidden="true">4.5.2.</strong> Recursive Types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../static_typing/user_defined_types/recursive_types/impossible_recursive_types/impossible_recursive_types.generated_docs.html"><strong aria-hidden="true">4.5.2.1.</strong> Impossible Recursive Types</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../type_inference/type_inference.generated_docs.html"><strong aria-hidden="true">5.</strong> Type Inference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../type_inference/required_type_annotations/required_type_annotations.generated_docs.html"><strong aria-hidden="true">5.1.</strong> Required Type Annotations</a></li></ol></li><li class="chapter-item expanded "><a href="../../../procedures.html"><strong aria-hidden="true">6.</strong> Procedures</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../procedures/functions/functions.generated_docs.html"><strong aria-hidden="true">6.1.</strong> Functions</a></li><li class="chapter-item expanded "><a href="../../../procedures/consumers/consumers.generated_docs.html"><strong aria-hidden="true">6.2.</strong> Consumers</a></li><li class="chapter-item expanded "><a href="../../../procedures/providers/providers.generated_docs.html"><strong aria-hidden="true">6.3.</strong> Providers</a></li></ol></li><li class="chapter-item expanded "><a href="../../../lambdas_and_first_class_procedures/lambdas_and_first_class_procedures.generated_docs.html"><strong aria-hidden="true">7.</strong> Lambdas & First Class Procedures</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../lambdas_and_first_class_procedures/lambda_closures/lambda_closures.generated_docs.html"><strong aria-hidden="true">7.1.</strong> Lambdas are Restricted "Closures"</a></li></ol></li><li class="chapter-item expanded "><a href="../../../error_handling/error_handling.generated_docs.html"><strong aria-hidden="true">8.</strong> Error Handling</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../error_handling/error_propagation/error_propagation.generated_docs.html"><strong aria-hidden="true">8.1.</strong> Error Propagation</a></li></ol></li><li class="chapter-item expanded "><a href="../../../generics.generated_docs.html"><strong aria-hidden="true">9.</strong> Generics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../generics/contracts/contracts.generated_docs.html"><strong aria-hidden="true">9.1.</strong> Contracts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../generics/contracts/implementing_contracts/implementing_contracts.generated_docs.html"><strong aria-hidden="true">9.1.1.</strong> Implementing a Contract</a></li><li class="chapter-item expanded "><a href="../../../generics/contracts/multiple_type_params/multiple_type_params.generated_docs.html"><strong aria-hidden="true">9.1.2.</strong> Multiple Type Params</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../generics/contracts/multiple_type_params/implied_types/implied_types.generated_docs.html"><strong aria-hidden="true">9.1.2.1.</strong> (Advanced) Implied Types</a></li></ol></li><li class="chapter-item expanded "><a href="../../../generics/contracts/dynamic_dispatch/dynamic_dispatch.generated_docs.html"><strong aria-hidden="true">9.1.3.</strong> Dynamic Dispatch</a></li></ol></li><li class="chapter-item expanded "><a href="../../../generics/generic_return_type_inference/generic_return_type_inference.generated_docs.html"><strong aria-hidden="true">9.2.</strong> Generic Return Type Inference</a></li></ol></li><li class="chapter-item expanded "><a href="../../../copying/copying.generated_docs.html"><strong aria-hidden="true">10.</strong> Copying Data</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../copying/mutability_coercion/mutability_coercion.generated_docs.html"><strong aria-hidden="true">10.1.</strong> Mutability Coercion on Copy</a></li><li class="chapter-item expanded "><a href="../../../copying/performance/performance.generated_docs.html"><strong aria-hidden="true">10.2.</strong> Performance Optimizations</a></li><li class="chapter-item expanded "><a href="../../../copying/known_bugs/known_bugs.generated_docs.html"><strong aria-hidden="true">10.3.</strong> Known Copy Bugs</a></li></ol></li><li class="chapter-item expanded "><a href="../../../resource_files/resource_files.generated_docs.html"><strong aria-hidden="true">11.</strong> Resource Files</a></li><li class="chapter-item expanded "><a href="../../../module_system/module_system.generated_docs.html"><strong aria-hidden="true">12.</strong> Module System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../module_system/module_apis/module_apis.generated_docs.html"><strong aria-hidden="true">12.1.</strong> Module APIs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../module_system/module_apis/procedure_signatures/procedure_signatures.generated_docs.html"><strong aria-hidden="true">12.1.1.</strong> Procedure Signatures</a></li><li class="chapter-item expanded "><a href="../../../module_system/module_apis/type_definitions/type_definitions.generated_docs.html"><strong aria-hidden="true">12.1.2.</strong> Type & Alias Definitions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../module_system/module_apis/type_definitions/initializers_and_unwrappers/initializers_and_unwrappers.generated_docs.html"><strong aria-hidden="true">12.1.2.1.</strong> Initializers</a></li><li class="chapter-item expanded "><a href="../../../module_system/module_apis/type_definitions/initializers_and_unwrappers/unwrappers/unwrappers.generated_docs.html"><strong aria-hidden="true">12.1.2.2.</strong> Unwrappers</a></li><li class="chapter-item expanded "><a href="../../../module_system/module_apis/type_definitions/opaque_types/opaque_types.generated_docs.html"><strong aria-hidden="true">12.1.2.3.</strong> Opaque Types</a></li></ol></li><li class="chapter-item expanded "><a href="../../../module_system/module_apis/static_values/static_values.generated_docs.html"><strong aria-hidden="true">12.1.3.</strong> Static Values</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../module_system/module_apis/flags/flags.generated_docs.html"><strong aria-hidden="true">12.1.3.1.</strong> Flags</a></li></ol></li><li class="chapter-item expanded "><a href="../../../module_system/module_apis/http_services/http_services.generated_docs.html"><strong aria-hidden="true">12.1.4.</strong> HTTP Services</a></li></ol></li><li class="chapter-item expanded "><a href="../../../module_system/visibility/visibility.generated_docs.html"><strong aria-hidden="true">12.2.</strong> Visibility</a></li><li class="chapter-item expanded "><a href="../../../module_system/swapping_deps/swapping_deps.generated_docs.html"><strong aria-hidden="true">12.3.</strong> Swapping Dependencies</a></li></ol></li><li class="chapter-item expanded "><a href="../../../concurrency.html"><strong aria-hidden="true">13.</strong> Concurrency</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../graph_procedures/graph_procedures.generated_docs.html"><strong aria-hidden="true">13.1.</strong> Graph Procedures</a></li><li class="chapter-item expanded "><a href="../../../graph_procedures/graph_procedure_composition/graph_procedure_composition.generated_docs.html"><strong aria-hidden="true">13.2.</strong> Graph Procedure Composition</a></li><li class="chapter-item expanded "><a href="../../../graph_procedures/calling_graph_procedures/calling_graph_procedures.generated_docs.html"><strong aria-hidden="true">13.3.</strong> Calling Graph Procedures</a></li><li class="chapter-item expanded "><a href="../../../graph_procedures/conditional_subgraph_execution/conditional_subgraph_execution.generated_docs.html"><strong aria-hidden="true">13.4.</strong> (Advanced) Conditional Subgraph Execution</a></li></ol></li><li class="chapter-item expanded "><a href="../../../fearless_concurrency/fearless_concurrency.html"><strong aria-hidden="true">14.</strong> Fearless Concurrency</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../guaranteed_data_race_free/guaranteed_data_race_free.generated_docs.html"><strong aria-hidden="true">14.1.</strong> Guaranteed Data-Race-Free Concurrency</a></li><li class="chapter-item expanded "><a href="../../../guaranteed_deadlock_free.html"><strong aria-hidden="true">14.2.</strong> Guaranteed Deadlock-Free Concurrency</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../guaranteed_deadlock_free/blocking_procedures/blocking_procedures.generated_docs.html"><strong aria-hidden="true">14.2.1.</strong> Blocking Procedures</a></li><li class="chapter-item expanded "><a href="../../../guaranteed_deadlock_free/re_what_color_is_your_function.generated_docs.html"><strong aria-hidden="true">14.2.2.</strong> Re: "What Color is Your Function?"</a></li><li class="chapter-item expanded "><a href="../../../guaranteed_deadlock_free/re_what_color_is_your_function/blocking_generics.generated_docs.html"><strong aria-hidden="true">14.2.3.</strong> (Advanced) Blocking Generics</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../http_servers/http_servers.generated_docs.html"><strong aria-hidden="true">15.</strong> Basic HTTP Servers</a></li><li class="chapter-item expanded "><a href="../../../json_parsing/json_parsing.generated_docs.html"><strong aria-hidden="true">16.</strong> JSON Parsing</a></li><li class="chapter-item expanded "><a href="../../../metaprogramming/metaprogramming.generated_docs.html"><strong aria-hidden="true">17.</strong> Build Time Metaprogramming</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../metaprogramming/templating/templating.generated_docs.html"><strong aria-hidden="true">17.1.</strong> Source Code Templates</a></li><li class="chapter-item expanded "><a href="../../../metaprogramming/code_reuse/code_reuse.generated_docs.html"><strong aria-hidden="true">17.2.</strong> (Literal) Code Reuse</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../metaprogramming/code_reuse/reusing_module_apis/reusing_module_apis.generated_docs.html"><strong aria-hidden="true">17.2.1.</strong> Reusing Module APIs</a></li><li class="chapter-item expanded "><a href="../../../metaprogramming/code_reuse/reusing_source_code/reusing_source_code.generated_docs.html" class="active"><strong aria-hidden="true">17.2.2.</strong> Reusing Source Code</a></li><li class="chapter-item expanded "><a href="../../../metaprogramming/code_reuse/abstract_modules/abstract_modules.generated_docs.html"><strong aria-hidden="true">17.2.3.</strong> Abstract Modules</a></li><li class="spacer"></li></ol></li></ol></li><li class="chapter-item expanded "><li class="part-title">StdLib</li><li class="chapter-item expanded "><a href="../../../stdlib/default_modules/default_modules.generated_docs.html"><strong aria-hidden="true">18.</strong> Default Modules</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../stdlib/booleans_module.generated_docs.html"><strong aria-hidden="true">18.1.</strong> booleans</a></li><li class="chapter-item expanded "><a href="../../../stdlib/deque_module.generated_docs.html"><strong aria-hidden="true">18.2.</strong> deque</a></li><li class="chapter-item expanded "><a href="../../../stdlib/doubles_module.generated_docs.html"><strong aria-hidden="true">18.3.</strong> doubles</a></li><li class="chapter-item expanded "><a href="../../../stdlib/files_module.generated_docs.html"><strong aria-hidden="true">18.4.</strong> files</a></li><li class="chapter-item expanded "><a href="../../../stdlib/floats_module.generated_docs.html"><strong aria-hidden="true">18.5.</strong> floats</a></li><li class="chapter-item expanded "><a href="../../../stdlib/futures_module.generated_docs.html"><strong aria-hidden="true">18.6.</strong> futures</a></li><li class="chapter-item expanded "><a href="../../../stdlib/fp_module.generated_docs.html"><strong aria-hidden="true">18.7.</strong> fp</a></li><li class="chapter-item expanded "><a href="../../../stdlib/ints_module.generated_docs.html"><strong aria-hidden="true">18.8.</strong> ints</a></li><li class="chapter-item expanded "><a href="../../../stdlib/lists_module.generated_docs.html"><strong aria-hidden="true">18.9.</strong> lists</a></li><li class="chapter-item expanded "><a href="../../../stdlib/longs_module.generated_docs.html"><strong aria-hidden="true">18.10.</strong> longs</a></li><li class="chapter-item expanded "><a href="../../../stdlib/maps_module.generated_docs.html"><strong aria-hidden="true">18.11.</strong> maps</a></li><li class="chapter-item expanded "><a href="../../../stdlib/math_module.generated_docs.html"><strong aria-hidden="true">18.12.</strong> math</a></li><li class="chapter-item expanded "><a href="../../../stdlib/priority_queue_module.generated_docs.html"><strong aria-hidden="true">18.13.</strong> priority_queue</a></li><li class="chapter-item expanded "><a href="../../../stdlib/random_module.generated_docs.html"><strong aria-hidden="true">18.14.</strong> random</a></li><li class="chapter-item expanded "><a href="../../../stdlib/scanner_module.generated_docs.html"><strong aria-hidden="true">18.15.</strong> scanner</a></li><li class="chapter-item expanded "><a href="../../../stdlib/sets_module.generated_docs.html"><strong aria-hidden="true">18.16.</strong> sets</a></li><li class="chapter-item expanded "><a href="../../../stdlib/std_module.generated_docs.html"><strong aria-hidden="true">18.17.</strong> std</a></li><li class="chapter-item expanded "><a href="../../../stdlib/strings_module.generated_docs.html"><strong aria-hidden="true">18.18.</strong> strings</a></li><li class="chapter-item expanded "><a href="../../../stdlib/string_builder_module.generated_docs.html"><strong aria-hidden="true">18.19.</strong> string_builder</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Claro Programming Language (DRAFT)</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/JasonSteving99/claro-lang/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="reusing-source-code"><a class="header" href="#reusing-source-code">Reusing Source Code</a></h1>
<p>Continuing to consider the &quot;Animals&quot; example from the 
<a href="../reusing_module_apis/reusing_module_apis.generated_docs.html">previous section</a>, let's consider a simple refactoring.</p>
<p>As a reminder, previously, calls to <code>AnimalSounds::makeNoise(...)</code> produced very simple output:</p>
<h4 id="fig-1"><a class="header" href="#fig-1"><em>Fig 1:</em></a></h4>
<hr />
<pre><code class="language-claro"># animals_example.claro
var animals: [oneof&lt;Cat::State, Dog::State&gt;] = [
    Dog::create(&quot;Milo&quot;, true),
    Dog::create(&quot;Fido&quot;, false),
    Cat::create(&quot;Garfield&quot;, &quot;This is worse than Monday morning.&quot;)
  ];

for (animal in animals) {
  print(AnimalSounds::AnimalSounds::makeNoise(animal));
}
</code></pre>
<p><em>Output:</em></p>
<pre><code>Woof!
Grrrr...
This is worse than Monday morning.
</code></pre>
<hr />
<p>As currently defined...</p>
<h4 id="fig-2"><a class="header" href="#fig-2"><em>Fig 2:</em></a></h4>
<hr />
<pre><code class="language-python"># BUILD
load(&quot;:animals.bzl&quot;, &quot;Animal&quot;)

Animal(name = &quot;dog&quot;, srcs = [&quot;dog.claro&quot;])
Animal(name = &quot;cat&quot;, srcs = [&quot;cat.claro&quot;])
</code></pre>
<hr />
<p>...if we wanted to include the animals' names in the printed lines. We'd have to go and manually update each 
Module's implementation, making changes to both <code>dog.claro</code> and <code>cat.claro</code> (and importantly, to any other animals we'd
want to share this updated behavior):</p>
<h4 id="fig-3"><a class="header" href="#fig-3"><em>Fig 3:</em></a></h4>
<hr />
<pre><code class="language-claro"># cat.claro
newtype InternalState : struct { favoriteInsult: string }

implement AnimalSounds::AnimalSounds&lt;State&gt; {
  function makeNoise(cat: State) -&gt; string {
    # Cats are mean, they're going to say mean things no matter what.
    var noise = unwrap(unwrap(cat).internal).favoriteInsult;
    return &quot;{noise} - says {unwrap(cat).name}&quot;; # Analogous code repeated in dog.claro.
  }
}
<span class="boring">
</span><span class="boring">function create(name: string, favoriteInsult: string) -&gt; State {
</span><span class="boring">  return State({
</span><span class="boring">    name = name,
</span><span class="boring">    internal = InternalState({favoriteInsult = favoriteInsult})
</span><span class="boring">  });
</span><span class="boring">}
</span></code></pre>
<hr />
<p>And now, after making the changes, rerunning will give us the updated output we were looking for:</p>
<h4 id="fig-4"><a class="header" href="#fig-4"><em>Fig 4:</em></a></h4>
<hr />
<pre><code>Woof! - says Milo
Grrrr... - says Fido
This is worse than Monday morning. - says Garfield
</code></pre>
<hr />
<p>Repetition may be ok in some situations, but in many others, it would represent a risk of potential maintenance costs.</p>
<p>Of course, you could always factor out the common logic into a new Module that can be depended on and called explicitly
by each animal implementation (and in fact, <strong>this is absolutely the recommended approach in most situations</strong>). But,
since we're interested in digging into possible Build time metaprogramming capabilities in this section, by way of
example, we'll walk through <em><strong>some other ways</strong></em> you could go about <em><strong>sharing</strong></em> this base implementation across
Modules that potentially wouldn't have been immediately obvious, coming from other languages.</p>
<h2 id="claro_module-accepts-multiple-srcs"><a class="header" href="#claro_module-accepts-multiple-srcs"><code>claro_module(...)</code> Accepts Multiple Srcs</a></h2>
<p>The first thing to understand is that a Module's implementation <em><strong>can be spread across multiple source files</strong></em>. This
means that different <code>.claro</code> files can satisfy different portions of a Module's API. And, more importantly for our
current purposes, this means that instead of creating a whole new Module to contain the common logic factored out of
<code>dog.claro</code> and <code>cat.claro</code>, we could instead define a single new file containing that factored out logic...</p>
<h4 id="fig-5"><a class="header" href="#fig-5"><em>Fig 5:</em></a></h4>
<hr />
<pre><code class="language-claro"># get_message_with_name.claro
function getMessageWithName(message: string, state: State) -&gt; string {
  var name = unwrap(state).name; # All animal States have a top-level `name` field.
  return &quot;{message} - says {name}&quot;;
}
</code></pre>
<hr />
<p>...include it in the <code>srcs</code> of <strong><em>BOTH</em></strong> Module declarations...</p>
<h4 id="fig-6"><a class="header" href="#fig-6"><em>Fig 6:</em></a></h4>
<hr />
<pre><code class="language-python"># BUILD
load(&quot;:animals.bzl&quot;, &quot;Animal&quot;)

# An example of **LITERALLY** reusing code.
Animal(name = &quot;dog&quot;, srcs = [&quot;dog.claro&quot;, &quot;get_message_with_name.claro&quot;])
Animal(name = &quot;cat&quot;, srcs = [&quot;cat.claro&quot;, &quot;get_message_with_name.claro&quot;])
</code></pre>
<hr />
<p>...and then directly call the factored out function in <em>each</em> Module's implementation!</p>
<h4 id="fig-7"><a class="header" href="#fig-7"><em>Fig 7:</em></a></h4>
<hr />
<pre><code class="language-claro"># cat.claro
<span class="boring">newtype InternalState : struct { favoriteInsult: string }
</span><span class="boring">
</span>implement AnimalSounds::AnimalSounds&lt;State&gt; {
  function makeNoise(cat: State) -&gt; string {
    var noise = unwrap(unwrap(cat).internal).favoriteInsult;
    return getMessageWithName(noise, cat); # Analogous code repeated in dog.claro.
  }
}
<span class="boring">
</span><span class="boring">function create(name: string, favoriteInsult: string) -&gt; State {
</span><span class="boring">  return State({
</span><span class="boring">    name = name,
</span><span class="boring">    internal = InternalState({favoriteInsult = favoriteInsult})
</span><span class="boring">  });
</span><span class="boring">}
</span></code></pre>
<hr />
<p>This is an example of <strong><em>LITERAL</em></strong> code reuse - something that's generally not actually possible in other languages.
In fact, you could take this a step further by factoring out this shared src file directly into the <code>Animal(...)</code> 
<a href="../reusing_module_apis/reusing_module_apis.generated_docs.html#declaring-a-macro-in-a-bzl-file-to-make-this-factored-out-build-logic-portable">Macro implementation</a>
to <em>automatically</em> make the <code>getMessageWithName(...)</code> function available to <strong>all</strong> <code>Animal(...)</code> declarations.</p>
<div class="warning">
<p>The key to this all working is that when the reused function references the <code>State</code> Type, it refers to either 
<code>Dog::State</code> or <code>Cat::State</code> depending on the context in which it's compiled. And the only field accessed via
<code>unwrap(state).name</code> is valid for both types. In a sense, this form of Build time metaprogramming has given this 
strongly, statically typed programming language the ability to drop down into dynamic &quot;duck typing&quot; features when it's
convenient to us. This utterly blurs the lines between the two typing paradigms while still maintaining all of the
static type validations because all of this is happening at Build time, with Compile time's type-checking validations
still to follow!</p>
</div>
<h2 id="inheritance---inverting-the-prior-example"><a class="header" href="#inheritance---inverting-the-prior-example">&quot;Inheritance&quot; - Inverting the Prior Example</a></h2>
<p>The prior example is a demonstration of the &quot;composition&quot; model where, in order to share code, you <strong><em>explicitly</em></strong> 
compose new code around the shared code by <strong><em>manually</em></strong> calling into the shared code. </p>
<p>But, of course, while composition is generally recommended over the inverted &quot;inheritance&quot; model, many people prefer the
convenience that inheritance-based designs offer. Specifically, as you saw in the prior example, composition is more
verbose, as you have to <strong><em>explicitly</em></strong> opt in to code sharing, whereas inheritance makes this <strong><em>implicit</em></strong>.</p>
<p>Now, instead of each Module implementing the <code>AnimalSounds</code> Contract manually, a single default implementation could be
written...</p>
<h4 id="fig-8"><a class="header" href="#fig-8"><em>Fig 8:</em></a></h4>
<hr />
<pre><code class="language-claro"># default_animal_sounds_impl.claro
implement AnimalSounds::AnimalSounds&lt;State&gt; {
  function makeNoise(state: State) -&gt; string {
    return &quot;{makeNoiseImpl(state)} - says {unwrap(state).name}&quot;;
  }
}
</code></pre>
<hr />
<p>...and then each Animal Module simply needs to define the expected internal implementation function <code>makeNoiseImpl(...)</code>
to provide its custom logic...</p>
<h4 id="fig-9"><a class="header" href="#fig-9"><em>Fig 9:</em></a></h4>
<hr />
<pre><code class="language-claro"># cat.claro
<span class="boring">newtype InternalState : struct { favoriteInsult: string }
</span><span class="boring">
</span>function makeNoiseImpl(cat: State) -&gt; string {
  # No more code duplication.
  return unwrap(unwrap(cat).internal).favoriteInsult;
}
<span class="boring">
</span><span class="boring">function create(name: string, favoriteInsult: string) -&gt; State {
</span><span class="boring">  return State({
</span><span class="boring">    name = name,
</span><span class="boring">    internal = InternalState({favoriteInsult = favoriteInsult})
</span><span class="boring">  });
</span><span class="boring">}
</span></code></pre>
<hr />
<p>...and again, the &quot;inherited&quot; code can be included in the <code>srcs</code> of <strong><em>BOTH</em></strong> Module declarations...</p>
<h4 id="fig-10"><a class="header" href="#fig-10"><em>Fig 10:</em></a></h4>
<hr />
<pre><code class="language-python"># BUILD
load(&quot;:animals.bzl&quot;, &quot;Animal&quot;)

# An example of **LITERALLY** reusing code.
Animal(name = &quot;dog&quot;, srcs = [&quot;dog.claro&quot;, &quot;default_animal_sounds_impl.claro&quot;])
Animal(name = &quot;cat&quot;, srcs = [&quot;cat.claro&quot;, &quot;default_animal_sounds_impl.claro&quot;])
</code></pre>
<hr />
<div class="warning">
<p>Modern software engineering best practices have been progressing towards the consensus view that you should 
<a href="https://www.wikiwand.com/en/Composition_over_inheritance#Benefits" target="_blank">prefer composition over inheritance</a>.
But, even though this <em>preference</em> is generally shared by Claro's author, it shouldn't necessarily indicate that
inheritance is impossible to achieve. While Claro won't ever add first-class support for inheritance to the language,
Claro explicitly leaves these sorts of design decisions to you and provides Build time metaprogramming support to allow
the community to encode these sorts of organizational design patterns themselves to be available for whoever decides
they have a good reason for it. You shouldn't need to be hostage to the language designer's agreement or prioritization
to be able to extend the code organization patterns that can be expressed in the language.</p>
</div>
<h2 id="further-flexibility"><a class="header" href="#further-flexibility">Further Flexibility</a></h2>
<p>If you've made it this far, well done! You may never need to use these &quot;power user&quot; features, but you should now have
the core conceptual background that you'll need to use Bazel to encode your own relatively sophisticated custom 
organizational design patterns in your Claro programs using Build time metaprogramming! </p>
<p>Of course, there's always another step deeper into such waters. By continuing on to the next section, we'll continue to
develop the Animals example <em>even further</em>. In particular, we'll demonstrate one such sophisticated design pattern
called &quot;Abstract Modules&quot; that fully generalizes <em>all</em> of the functionality described in the past two sections, and
goes <em>even further</em> to provide significant configurability controls on top of what you've seen in the example 
<code>Animal(...)</code> macro so far.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../metaprogramming/code_reuse/reusing_module_apis/reusing_module_apis.generated_docs.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../metaprogramming/code_reuse/abstract_modules/abstract_modules.generated_docs.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../metaprogramming/code_reuse/reusing_module_apis/reusing_module_apis.generated_docs.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../metaprogramming/code_reuse/abstract_modules/abstract_modules.generated_docs.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../elasticlunr.min.js"></script>
        <script src="../../../mark.min.js"></script>
        <script src="../../../searcher.js"></script>

        <script src="../../../clipboard.min.js"></script>
        <script src="../../../highlight.js"></script>
        <script src="../../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../../mermaid@10.6.1.min.js"></script>
        <script src="../../../mermaid-init.js"></script>


    </div>
    </body>
</html>
